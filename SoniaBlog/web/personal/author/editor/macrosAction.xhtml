<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:blog="http://jab.nitilon.org/blog/"
      xmlns:c="http://java.sun.com/jstl/core"
      xmlns:u1="http://jab.nitilon.org/blog/">
  <body>

    <ui:composition template="./template.xhtml">

      <ui:define name="head">
        <script type="text/javascript" src="${facesContext.externalContext.requestContextPath}/resources/tiny_mce/plugins/macro/js/dialog.js"></script>
      </ui:define>

      <ui:define name="content">

        <c:set value="#{EditorBean.macroInformation}" var="Macro" />

        <script type="text/javascript">
          var name = '#{Macro.name}';
          var param = new Array();
          var paramName;
          var paramValue;
            <ui:repeat value="#{Macro.parameter}" var="InfoParam">
              paramName = '#{InfoParam.name}';
              paramValue = '<blog:widget widget="#{InfoParam.widget}" param="#{InfoParam.widgetParam}" name="#{InfoParam.name}" result="true" />';
              if ( paramName != '' &amp;&amp; paramValue != '' )
              {
                param.push( paramName + "=" + paramValue );
              }
            </ui:repeat>
          var out = "{" + name;
          for ( var i=0; i&lt;param.length; i++ )
          {
            if ( i == 0 ) out += ':';
            else out += ';'
            out += param[i];
          }
          out += "}{/" + name +'}';
          MacroDialog.insert( out );
        </script>
        
      </ui:define>

      <ui:define name="footer"></ui:define>

    </ui:composition>

  </body>
</html>

